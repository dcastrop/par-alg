poly T = K (() + int) + I * I;
poly L = K () + K int * I;

atom split : Rec L -> T Rec L;

atom merge : Rec L * Rec L -> Rec L;

fun nil : () -> Rec L
  = in . inj[0,2];

fun cons : int * Rec L -> Rec L
  = in . inj[1,2];

fun singleton : int -> Rec L
  = cons . (id &&& (nil . const ()));

fun ms : Rec L -> Rec L
  = rec [T] ((nil ||| singleton) ||| merge) split;

par msp = ms {
  unroll 1;
  annotate
    {
    merge
    ;
    rec [T] merge split
    }
};
